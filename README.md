# Drone-FCC-Project

# 본격적으로 32bit MCU를 활용한 프로젝트 입니다.
# ST사의 M3, M4를 사용하였고 다수의 센서가 활용되었습니다.

FCC폴더를 제외한 나머지 파일들은 TrueStudio 플랫폼과 Cube MX 플랫폼 기반의 개발로 진행이 되었고 
FCC폴더는 orcad 플랫폼에서 M4와 사용한 센서들을 융합한 회로 설계 파일입니다.
시간이 부족해 풋프린트와 아트윅을 진행하지 못해 회로 설계까지만 되어있습니다.

코드는 Cube MX에서 제공하는 HAL ,CMSIS 라이브러리를 기반으로 작성되어 있으며 6축 센서의 RAW데이터를 쿼터니언 값으로 계산해주는 코드를 제외한
나머지 코드들은 손수 작성을 하였습니다.

드론 특성상 딜레이 최소화를 위해 I2C를 통한 통신 라이브러리를 HAL라이브러리중 메모리를 읽는 방식을 사용했으며 비트 쉬프트 방식보다 
포인터 연산을 통해 정해진 주소로 데이터를 결합하는 방식을 사용하였습니다.

리시버의 데이터를 UART를 통해 FCC에 전달하는 코드는 S-bus 프로토콜 특성상 1채널당 11비트의 데이터로 구성되기 때문에 포인터연산과 비트쉬프트를 
같이 사용하였고 인터럽트와 DMA 방식 두가지를 사용해 보았습니다.(본 프로젝트에는 인터럽트 방식이 적용되어 있습니다)

레지스터 직접제어는 Dt값을 구하기 위한 타이머의 카운터레지스터를 volatile 키워드를 사용 컴파일 단계에서 최적화를 막아서 수행하였고 레지스터의 주소값은
데이터시트 분석과 TrueStudio 디버깅 모드를 사용하였습니다.
